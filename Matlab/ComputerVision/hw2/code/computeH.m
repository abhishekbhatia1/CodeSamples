function H2to1 = computeH(p1,p2)

A = zeros(2*size(p1,2),9);

A(1:2:end,1) = -p2(1,:)';
A(2:2:end,1) = 0;
A(1:2:end,2) = -p2(2,:)';
A(2:2:end,2) = 0;
A(1:2:end,3) = -1;
A(2:2:end,3) = 0;
A(1:2:end,4) = 0;
A(2:2:end,4) = -p2(1,:)';
A(1:2:end,5) = 0;
A(2:2:end,5) = -p2(2,:)';
A(1:2:end,6) = 0;
A(2:2:end,6) = -1;
A(1:2:end,7) = (p1(1,:).*p2(1,:))';
A(1:2:end,8) = (p1(1,:).*p2(2,:))';
A(1:2:end,9) = p1(1,:)';
A(2:2:end,7) = (p1(2,:).*p2(1,:))';
A(2:2:end,8) = (p1(2,:).*p2(2,:))';
A(2:2:end,9) = p1(2,:)';

[U,S,V] = svd(A);
C = size(S,2);
H2to1 = reshape(V(:,C),[3 3])';